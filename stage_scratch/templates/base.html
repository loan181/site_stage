<!DOCTYPE html>
<html>

{% load static %}

<head>
    <meta charset="UTF-8">
    <title> {% block title %}Default base title{% endblock title %}</title>

    <!-- Latest compiled and minified CSS -->
{#    <link rel="stylesheet" href="{% static "bootstrap-3.3.7-dist/css/bootstrap.min.css" %}">#}
    <link rel="stylesheet" href="{% static "bootstrap-4.1.3-dist/css/bootstrap.min.css" %}">

    <!-- Optional theme -->
{#    <link rel="stylesheet" href="{% static "bootstrap-3.3.7-dist/css/bootstrap-theme.min.css" %}">#}

    <!-- Custom style -->
    <link rel="stylesheet" href="{% static "style.css" %}">


    <script src="{% static "jquery-3.3.1.min.js" %}"></script>
    <script src="{% static "popper.min.js" %}"></script>


    <!-- Latest compiled and minified JavaScript -->
{#    <script src="{% static "bootstrap-3.3.7-dist/js/bootstrap.min.js" %}"></script>#}
    <script src="{% static "bootstrap-4.1.3-dist/js/bootstrap.min.js" %}"></script>

    <!-- ScratchBlocks API -->
    <script src="{% static "scratchBlocks/scratchblocks-v3-min.js" %}"></script>
    <script src="{% static "scratchBlocks/translations-v3-min.js" %}"></script>
    <script src="{% static "scratchBlocks/translations-fr-v3-min.js" %}"></script>

    <!-- Maths API -->
    <script type="text/javascript"
            src="{% static "mathjax/MathJax.js" %}?config=TeX-MML-AM_CHTML">
        {#        src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML'>#}
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>

    {% block extraScript %}
    {% endblock extraScript %}
</head>


<body>
<header>
    {# Navigation Menu #}

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="{% url 'index' %}">Scratch Stage</a>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>

            <div id="navbar" class="collapse navbar-collapse">
                <ul class="navbar-nav mr-auto">
                    {#                <li><a href="#about">About</a></li>#}
                    {#                <li><a href="#contact">Contact</a></li>#}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="https://example.com" id="dropdownConcepts" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img class="header-icn-rev" src="{% static "img/icons/concept.svg" %}"/>Concepts</a>
                        <div class="dropdown-menu" aria-labelledby="dropdownConcepts">
                            {% for conceptName in allConceptName %}
                                <a class="dropdown-item" href="{% url 'concept' conceptName%}">{{ conceptName }}</a>
                            {% endfor %}
                        </div>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'scratchOffline' %}"> <img class="header-icn-rev" src="{% static "img/icons/hammer.png" %}"/> Scratch hors-ligne</a></li>

                </ul>
                {#              <ul class="nav navbar-nav navbar-right">#}
                {#                <li><a href="../navbar/">Default</a></li>#}
                {#                <li><a href="../navbar-static-top/">Static top</a></li>#}
                {#                <li class="active"><a href="./">Fixed top <span class="sr-only">(current)</span></a></li>#}
                {#              </ul>#}
            </div><!--/.nav-collapse -->
        </div>
    </nav>

    {##}
    {#        <div class="navbar navbar-default navbar-fixed-top#}
    {#        {% block nav-style %}{% endblock %}">#}
    {#            <div class="container p-none">#}
    {#                <div class="navbar-header">#}
    {#                    <button type="button" class="navbar-toggle"#}
    {#                            data-toggle="collapse"#}
    {#                            data-target=".navbar-collapse">#}
    {#                        <span class="icon-bar"></span>#}
    {#                        <span class="icon-bar"></span>#}
    {#                        <span class="icon-bar"></span>#}
    {#                    </button>#}
    {#                    <a class="navbar-brand" href="{% url 'index' %}">Scratch Stage</a>#}
    {#                </div>#}
    {##}
    {#                <div class="collapse navbar-collapse" id="navbarSupportedContent">#}
    {#                    <ul class="navbar-nav mr-auto">#}
    {#                        <li class="nav-item active">#}
    {#                            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>#}
    {#                        </li>#}
    {#                        <li class="nav-item">#}
    {#                            <a class="nav-link" href="#">Link</a>#}
    {#                        </li>#}
    {#                        <li class="nav-item dropdown">#}
    {#                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">#}
    {#                                Dropdown#}
    {#                            </a>#}
    {#                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">#}
    {#                                <a class="dropdown-item" href="#">Action</a>#}
    {#                                <a class="dropdown-item" href="#">Another action</a>#}
    {#                                <div class="dropdown-divider"></div>#}
    {#                                <a class="dropdown-item" href="#">Something else here</a>#}
    {#                            </div>#}
    {#                        </li>#}
    {#                        <li class="nav-item">#}
    {#                            <a class="nav-link disabled" href="#">Disabled</a>#}
    {#                        </li>#}
    {#                    </ul>#}
    {#                    <form class="form-inline my-2 my-lg-0">#}
    {#                        <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">#}
    {#                        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>#}
    {#                    </form>#}
    {#                </div>#}

    {% comment %}
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        {% if user.is_authenticated %}
                            <li><a href="">Logout</a></li>
                            <li><a href=""
                                   class="p-r-none">Accounts</a></li>
                        {% else %}
                            <li><a href="">Login</a></li>
                            <li><a href="" class="p-r-none">Sign Up</a></li>
                        {% endif %}
                    </ul>
                </div>
                {% endcomment %}
</header>

{# The Document Body #}
<main role="main" class="container">
    <div class="starter-template">
        {% block content %}
            No content were provided
        {% endblock content %}
    </div>
</main>


{# Footer #}
<footer class="footer">
    <div class="container">
        <p class="text-muted">
            © 2018 : Sens Loan
            <br>
            Fait par Loan Sens dans le cadre éducatif strict de l'apprentissage de la  programmation à des jeunes
        </p>
    </div>
</footer>

{# Loaded blockly blocks #}
<script type="text/javascript">
    $(document).ready(function() {
        scratchblocks.renderMatching("pre.blocks",
            {languages: ['en', 'fr']});
        scratchblocks.renderMatching("code.blocksInline",
            {languages: ['en', 'fr'], inline:true});
    });
</script>

{# Automatically load Scratch Offline projects #}
<script>
    var scratchLoadTarget = null; // target that must load it's scratch content

    // Refresh la cible avec l'événement d'afichage
    $(".collapse").on('show.bs.collapse', function () {
        console.log("EVENT");
        scratchLoadTarget = jQuery(this).find("embed"); // utiliser .find ??
    });

    // Toggle in edition mode for a given scratch project
    function toggleEdition(scratchOfflineProject) {
        console.log("Toggle edition for :");
        console.log(scratchOfflineProject);
        if (scratchOfflineProject.getAttribute("data-editmode") === "True") {
            scratchOfflineProject.setAttribute("data-editmode", "False");
        }
        else {
            scratchOfflineProject.setAttribute("data-editmode", "True");
        }
        loadEdition(scratchOfflineProject);
    }

    // Set Edition mode base on data-editmode information
    function loadEdition(scratchOfflineProject) {
        if (scratchOfflineProject.getAttribute("data-editmode") === "True") {
            scratchOfflineProject.ASsetEditMode(true);
        }
        else {
            scratchOfflineProject.ASsetEditMode(false);
        }
    }

    // Set loading file based on data-sbfile information
    function loadFile(scratchOfflineProject) {
        var url = "{% static "scratch/files/" %}"+scratchOfflineProject.getAttribute("data-sbfile")+".sb2";
        console.log("URL : " + url);
        scratchOfflineProject.ASloadProjectUrl(url);
    }

    // Appelé automatiquement par le swf de scratch au démarrage
    function JSeditorReady() {
        console.log("CALL to JSeditorReady, with target : ");
        console.log(scratchLoadTarget);

        if (scratchLoadTarget != null) {
            for (var i=0; i<scratchLoadTarget.length; i++) {
                // Load l'URL
                loadFile(scratchLoadTarget[i]);
                // Load le mode éditeur ou jeu
                loadEdition(scratchLoadTarget[i]);
            }
        } else {
            console.warn("Appel de JSeditorReady sans cible");
        }

        return true;
    }

</script>


</body>


</html>